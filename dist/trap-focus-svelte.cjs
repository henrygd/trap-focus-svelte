let t=[];exports.trapFocus=function(e,n=1){let o,c=0;function u(){const t=Array.from(e.querySelectorAll("*")).filter((t=>t.tabIndex>=0));return[t.at(0)??e,t.at(-1)??e]}function r(){t.push(e),o=document.activeElement,u().at(0)?.focus()}function s(){t=t.filter((t=>t!=e)),o.focus()}n&&r();const f=e=>t.at(-1)?.contains(e),i=t=>{if(f(e)){const[e,n]=u();t.target==e&&c?n.focus():t.target!=n||c||e.focus()}},d=t=>{if(f(e)&&!f(t.target)){const[t,e]=u();(c?e:t).focus()}},a=t=>c=t.shiftKey&&"Tab"==t.key;return document.addEventListener("keydown",a),document.addEventListener("focusout",i),document.addEventListener("focusin",d),{update(t){t?r():s()},destroy(){s(),document.removeEventListener("focusout",i),document.removeEventListener("focusin",d),document.removeEventListener("keydown",a)}}};
