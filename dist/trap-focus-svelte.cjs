function t(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}let e=[];exports.trapFocus=function(n,o=1){let c=0;const u=t(document,"keydown",(t=>c=t.shiftKey&&"Tab"==t.key));function s(){const t=[...n.querySelectorAll("*")].filter((t=>t.tabIndex>=0));return[t.at(0)??n,t.at(-1)??n]}let r;function f(){e.push(n),r=document.activeElement,s().at(0).focus()}function i(){e=e.filter((t=>t!=n)),r.focus()}o&&f();const a=t=>e.at(-1)?.contains(t),d=t(n,"focusout",(t=>{if(a(n)){const[e,n]=s();t.target==e&&c?n.focus():t.target!=n||c||e.focus()}})),l=t(document,"focusin",(t=>{if(a(n)&&!a(t.target)){const[t,e]=s();(c?e:t).focus()}}));return{update(t){t?f():i()},destroy(){u(),l(),d(),i()}}};
