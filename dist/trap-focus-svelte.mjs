let t=[];function e(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}function n(n,o=1){let c=0;const u=e(document,"keydown",(t=>c=t.shiftKey&&"Tab"==t.key));function r(){const t=[...n.querySelectorAll("*")].filter((t=>t.tabIndex>=0));return[t.at(0)??n,t.at(-1)??n]}let s;function f(){t.push(n),s=document.activeElement,r().at(0).focus()}function i(){t=t.filter((t=>t!=n)),s.focus()}o&&f();const a=e=>t.at(-1)?.contains(e),d=e(n,"focusout",(t=>{if(a(n)){const[e,n]=r();t.target==e&&c?n.focus():t.target!=n||c||e.focus()}})),l=e(document,"focusin",(t=>{if(a(n)&&!a(t.target)){const[t,e]=r();(c?e:t).focus()}}));return{update(t){t?f():i()},destroy(){u(),l(),d(),i()}}}export{n as trapFocus};
